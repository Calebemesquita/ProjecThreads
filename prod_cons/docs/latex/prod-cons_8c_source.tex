\doxysection{prod-\/cons.c}
\hypertarget{prod-cons_8c_source}{}\label{prod-cons_8c_source}\mbox{\hyperlink{prod-cons_8c}{Ir para a documentação desse arquivo.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00001}00001\ \textcolor{preprocessor}{\#include\ <stdio.h>}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00002}00002\ \textcolor{preprocessor}{\#include\ <stdlib.h>}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00003}00003\ \textcolor{preprocessor}{\#include\ <pthread.h>}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00004}00004\ \textcolor{preprocessor}{\#include\ <semaphore.h>}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00005}00005\ \textcolor{preprocessor}{\#include\ <unistd.h>}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00006}00006\ \textcolor{preprocessor}{\#include\ <time.h>}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00029}00029\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00034}\mbox{\hyperlink{prod-cons_8c_a6b20d41d6252e9871430c242cb1a56e7}{00034}}\ \textcolor{preprocessor}{\#define\ BUFFER\_SIZE\ 5}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00035}00035\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00040}\mbox{\hyperlink{prod-cons_8c_a35219978a46af884c0f14963e979dbad}{00040}}\ \textcolor{preprocessor}{\#define\ NUM\_PRODUCERS\ 3}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00041}00041\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00046}\mbox{\hyperlink{prod-cons_8c_a642ed9b3c92cf525bd21bc6b630e1eed}{00046}}\ \textcolor{preprocessor}{\#define\ NUM\_CONSUMERS\ 1}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00047}00047\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00057}\mbox{\hyperlink{structproducer__args}{00057}}\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00058}00058\ \{}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00059}\mbox{\hyperlink{structproducer__args_ab488bfc5d1f76143651f915915046354}{00059}}\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structproducer__args_ab488bfc5d1f76143651f915915046354}{thread\_id}};}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00060}\mbox{\hyperlink{structproducer__args_ade4eec1ec53e96b62203ac10a9126465}{00060}}\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structproducer__args_ade4eec1ec53e96b62203ac10a9126465}{num\_sales}};}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00061}00061\ \}\ \mbox{\hyperlink{structproducer__args}{producer\_args}};}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00062}00062\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00067}\mbox{\hyperlink{prod-cons_8c_aa5b659cea6be80e6d304d4430d270ecd}{00067}}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{prod-cons_8c_aa5b659cea6be80e6d304d4430d270ecd}{buffer}}[\mbox{\hyperlink{prod-cons_8c_a6b20d41d6252e9871430c242cb1a56e7}{BUFFER\_SIZE}}];}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00068}00068\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00073}\mbox{\hyperlink{prod-cons_8c_ad43c3812e6d13e0518d9f8b8f463ffcf}{00073}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{prod-cons_8c_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00074}00074\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00079}\mbox{\hyperlink{prod-cons_8c_ab3926cfd7377a5ede3d3dc0a04986d13}{00079}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{prod-cons_8c_ab3926cfd7377a5ede3d3dc0a04986d13}{in\_idx}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00080}00080\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00085}\mbox{\hyperlink{prod-cons_8c_a7fadacd6eebc32b564c8d08c480b839c}{00085}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{prod-cons_8c_a7fadacd6eebc32b564c8d08c480b839c}{out\_idx}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00086}00086\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00091}\mbox{\hyperlink{prod-cons_8c_a4acff8232e4aec9cd5c6dc200ac55ef3}{00091}}\ pthread\_mutex\_t\ \mbox{\hyperlink{prod-cons_8c_a4acff8232e4aec9cd5c6dc200ac55ef3}{mutex}};}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00092}00092\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00097}\mbox{\hyperlink{prod-cons_8c_ac4b4123acdd4ff1886c11fd9b0918f19}{00097}}\ sem\_t\ \mbox{\hyperlink{prod-cons_8c_ac4b4123acdd4ff1886c11fd9b0918f19}{empty\_slots}};}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00098}00098\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00103}\mbox{\hyperlink{prod-cons_8c_ab0f9446b575ad1c8a51548638b7af8e0}{00103}}\ sem\_t\ \mbox{\hyperlink{prod-cons_8c_ab0f9446b575ad1c8a51548638b7af8e0}{full\_slots}};}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00104}00104\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00109}\mbox{\hyperlink{prod-cons_8c_a87c6d5157fa0f10d82e0abded1d885f3}{00109}}\ pthread\_cond\_t\ \mbox{\hyperlink{prod-cons_8c_a87c6d5157fa0f10d82e0abded1d885f3}{buffer\_full\_cond}};}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00110}00110\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00115}\mbox{\hyperlink{prod-cons_8c_a436d59982386b19ceee4af143321b585}{00115}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{prod-cons_8c_a436d59982386b19ceee4af143321b585}{active\_producers}}\ =\ \mbox{\hyperlink{prod-cons_8c_a35219978a46af884c0f14963e979dbad}{NUM\_PRODUCERS}};}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00116}00116\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00132}\mbox{\hyperlink{prod-cons_8c_a13f485a0cfd6e52c071bef0b7adb70cf}{00132}}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{prod-cons_8c_a13f485a0cfd6e52c071bef0b7adb70cf}{producer}}(\textcolor{keywordtype}{void}\ *args)}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00133}00133\ \{}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00134}00134\ \ \ \ \ \mbox{\hyperlink{structproducer__args}{producer\_args}}\ *p\_args\ =\ (\mbox{\hyperlink{structproducer__args}{producer\_args}}\ *)args;}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00135}00135\ \ \ \ \ \textcolor{keywordtype}{int}\ tid\ =\ p\_args-\/>\mbox{\hyperlink{structproducer__args_ab488bfc5d1f76143651f915915046354}{thread\_id}};}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00136}00136\ \ \ \ \ \textcolor{keywordtype}{int}\ sales\_to\_produce\ =\ p\_args-\/>\mbox{\hyperlink{structproducer__args_ade4eec1ec53e96b62203ac10a9126465}{num\_sales}};}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00137}00137\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00138}00138\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ sales\_to\_produce;\ i++)}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00139}00139\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00140}00140\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ sale\_value\ =\ (rand()\ \%\ 100000)\ /\ 100.0\ +\ 1.0;\ \textcolor{comment}{//\ Gera\ um\ valor\ de\ venda\ aleatório\ entre\ 1.00\ e\ 1000.00}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00141}00141\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00142}00142\ \ \ \ \ \ \ \ \ sem\_wait(\&\mbox{\hyperlink{prod-cons_8c_ac4b4123acdd4ff1886c11fd9b0918f19}{empty\_slots}});}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00143}00143\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00144}00144\ \ \ \ \ \ \ \ \ pthread\_mutex\_lock(\&\mbox{\hyperlink{prod-cons_8c_a4acff8232e4aec9cd5c6dc200ac55ef3}{mutex}});}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00145}00145\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00146}00146\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{prod-cons_8c_aa5b659cea6be80e6d304d4430d270ecd}{buffer}}[\mbox{\hyperlink{prod-cons_8c_ab3926cfd7377a5ede3d3dc0a04986d13}{in\_idx}}]\ =\ sale\_value;}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00147}00147\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{prod-cons_8c_ab3926cfd7377a5ede3d3dc0a04986d13}{in\_idx}}\ =\ (\mbox{\hyperlink{prod-cons_8c_ab3926cfd7377a5ede3d3dc0a04986d13}{in\_idx}}\ +\ 1)\ \%\ \mbox{\hyperlink{prod-cons_8c_a6b20d41d6252e9871430c242cb1a56e7}{BUFFER\_SIZE}};}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00148}00148\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{prod-cons_8c_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}}++;}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00149}00149\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00150}00150\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}(P)\ TID\ \%ld\ |\ Caixa\ \%d\ |\ VENDA:\ R\$\ \%.2f\ |\ ITERAÇÃO:\ \%d/\%d\ |\ Buffer:\ \%d/\%d\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00151}00151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pthread\_self(),\ tid,\ sale\_value,\ i\ +\ 1,\ sales\_to\_produce,\ \mbox{\hyperlink{prod-cons_8c_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}},\ \mbox{\hyperlink{prod-cons_8c_a6b20d41d6252e9871430c242cb1a56e7}{BUFFER\_SIZE}});}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00152}00152\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00153}00153\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{prod-cons_8c_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}}\ ==\ \mbox{\hyperlink{prod-cons_8c_a6b20d41d6252e9871430c242cb1a56e7}{BUFFER\_SIZE}})}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00154}00154\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00155}00155\ \ \ \ \ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}-\/-\/-\/\ BUFFER\ CHEIO!\ Notificando\ o\ gerente.\ -\/-\/-\/\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00156}00156\ \ \ \ \ \ \ \ \ \ \ \ \ pthread\_cond\_signal(\&\mbox{\hyperlink{prod-cons_8c_a87c6d5157fa0f10d82e0abded1d885f3}{buffer\_full\_cond}});}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00157}00157\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00158}00158\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00159}00159\ \ \ \ \ \ \ \ \ pthread\_mutex\_unlock(\&\mbox{\hyperlink{prod-cons_8c_a4acff8232e4aec9cd5c6dc200ac55ef3}{mutex}});}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00160}00160\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00161}00161\ \ \ \ \ \ \ \ \ sem\_post(\&\mbox{\hyperlink{prod-cons_8c_ab0f9446b575ad1c8a51548638b7af8e0}{full\_slots}});}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00162}00162\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00163}00163\ \ \ \ \ \ \ \ \ sleep((rand()\ \%\ 5)\ +\ 1);}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00164}00164\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00165}00165\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00166}00166\ \ \ \ \ pthread\_mutex\_lock(\&\mbox{\hyperlink{prod-cons_8c_a4acff8232e4aec9cd5c6dc200ac55ef3}{mutex}});}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00167}00167\ \ \ \ \ \mbox{\hyperlink{prod-cons_8c_a436d59982386b19ceee4af143321b585}{active\_producers}}-\/-\/;}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00168}00168\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00169}00169\ \ \ \ \ printf(\textcolor{stringliteral}{"{}(P)\ TID\ \%ld\ |\ Caixa\ \%d\ finalizou\ sua\ produção.\ Produtores\ ativos:\ \%d\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00170}00170\ \ \ \ \ \ \ \ \ \ \ \ pthread\_self(),\ tid,\ \mbox{\hyperlink{prod-cons_8c_a436d59982386b19ceee4af143321b585}{active\_producers}});}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00171}00171\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00172}00172\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{prod-cons_8c_a436d59982386b19ceee4af143321b585}{active\_producers}}\ ==\ 0)}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00173}00173\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00174}00174\ \ \ \ \ \ \ \ \ pthread\_cond\_broadcast(\&\mbox{\hyperlink{prod-cons_8c_a87c6d5157fa0f10d82e0abded1d885f3}{buffer\_full\_cond}});}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00175}00175\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00176}00176\ \ \ \ \ pthread\_mutex\_unlock(\&\mbox{\hyperlink{prod-cons_8c_a4acff8232e4aec9cd5c6dc200ac55ef3}{mutex}});}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00177}00177\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00178}00178\ \ \ \ \ free(p\_args);}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00179}00179\ \ \ \ \ pthread\_exit(NULL);}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00180}00180\ \}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00181}00181\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00197}\mbox{\hyperlink{prod-cons_8c_a6c0ce21bf6fb29cd5d2d0b367f315da1}{00197}}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{prod-cons_8c_a6c0ce21bf6fb29cd5d2d0b367f315da1}{consumer}}(\textcolor{keywordtype}{void}\ *args)}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00198}00198\ \{}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00199}00199\ \ \ \ \ \textcolor{keywordtype}{int}\ iteration\ =\ 1;}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00200}00200\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00201}00201\ \ \ \ \ \textcolor{keywordflow}{while}\ (1)}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00202}00202\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00203}00203\ \ \ \ \ \ \ \ \ pthread\_mutex\_lock(\&\mbox{\hyperlink{prod-cons_8c_a4acff8232e4aec9cd5c6dc200ac55ef3}{mutex}});}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00204}00204\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00205}00205\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{prod-cons_8c_ad43c3812e6d13e0518d9f8b8f463ffcf}{count\ <\ BUFFER\_SIZE\ \&\&\ active\_producers\ >}}\ 0)}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00206}00206\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00207}00207\ \ \ \ \ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}(C)\ TID\ \%ld\ |\ Gerente\ esperando\ o\ buffer\ encher\ (Atual:\ \%d/\%d)...\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00208}00208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pthread\_self(),\ \mbox{\hyperlink{prod-cons_8c_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}},\ \mbox{\hyperlink{prod-cons_8c_a6b20d41d6252e9871430c242cb1a56e7}{BUFFER\_SIZE}});}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00209}00209\ \ \ \ \ \ \ \ \ \ \ \ \ pthread\_cond\_wait(\&\mbox{\hyperlink{prod-cons_8c_a87c6d5157fa0f10d82e0abded1d885f3}{buffer\_full\_cond}},\ \&\mbox{\hyperlink{prod-cons_8c_a4acff8232e4aec9cd5c6dc200ac55ef3}{mutex}});}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00210}00210\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00211}00211\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00212}00212\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{prod-cons_8c_a436d59982386b19ceee4af143321b585}{active\_producers}}\ ==\ 0\ \&\&\ \mbox{\hyperlink{prod-cons_8c_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}}\ ==\ 0)}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00213}00213\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00214}00214\ \ \ \ \ \ \ \ \ \ \ \ \ pthread\_mutex\_unlock(\&\mbox{\hyperlink{prod-cons_8c_a4acff8232e4aec9cd5c6dc200ac55ef3}{mutex}});}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00215}00215\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00216}00216\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00217}00217\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00218}00218\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{prod-cons_8c_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}}\ >\ 0)}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00219}00219\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00220}00220\ \ \ \ \ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}(C)\ TID\ \%ld\ |\ Gerente\ iniciando\ processamento\ de\ \%d\ vendas.\ ITERAÇÃO:\ \%d\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00221}00221\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pthread\_self(),\ \mbox{\hyperlink{prod-cons_8c_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}},\ iteration);}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00222}00222\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00223}00223\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ total\_sum\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00224}00224\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ items\_consumed\ =\ \mbox{\hyperlink{prod-cons_8c_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}};}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00225}00225\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00226}00226\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ items\_consumed;\ i++)}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00227}00227\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00228}00228\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ sale\_value\ =\ \mbox{\hyperlink{prod-cons_8c_aa5b659cea6be80e6d304d4430d270ecd}{buffer}}[\mbox{\hyperlink{prod-cons_8c_a7fadacd6eebc32b564c8d08c480b839c}{out\_idx}}];}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00229}00229\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ total\_sum\ +=\ sale\_value;}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00230}00230\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{prod-cons_8c_a7fadacd6eebc32b564c8d08c480b839c}{out\_idx}}\ =\ (\mbox{\hyperlink{prod-cons_8c_a7fadacd6eebc32b564c8d08c480b839c}{out\_idx}}\ +\ 1)\ \%\ \mbox{\hyperlink{prod-cons_8c_a6b20d41d6252e9871430c242cb1a56e7}{BUFFER\_SIZE}};}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00231}00231\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00232}00232\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{prod-cons_8c_ad43c3812e6d13e0518d9f8b8f463ffcf}{count}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00233}00233\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00234}00234\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ average\ =\ total\_sum\ /\ items\_consumed;}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00235}00235\ \ \ \ \ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}(C)\ TID\ \%ld\ |\ MÉDIA\ das\ \%d\ vendas:\ R\$\ \%.2f\ |\ ITERAÇÃO:\ \%d\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00236}00236\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pthread\_self(),\ items\_consumed,\ average,\ iteration++);}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00237}00237\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00238}00238\ \ \ \ \ \ \ \ \ \ \ \ \ pthread\_mutex\_unlock(\&\mbox{\hyperlink{prod-cons_8c_a4acff8232e4aec9cd5c6dc200ac55ef3}{mutex}});}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00239}00239\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00240}00240\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ items\_consumed;\ i++)}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00241}00241\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00242}00242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sem\_post(\&\mbox{\hyperlink{prod-cons_8c_ac4b4123acdd4ff1886c11fd9b0918f19}{empty\_slots}});}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00243}00243\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00244}00244\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00245}00245\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00246}00246\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00247}00247\ \ \ \ \ \ \ \ \ \ \ \ \ pthread\_mutex\_unlock(\&\mbox{\hyperlink{prod-cons_8c_a4acff8232e4aec9cd5c6dc200ac55ef3}{mutex}});}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00248}00248\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00249}00249\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00250}00250\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00251}00251\ \ \ \ \ printf(\textcolor{stringliteral}{"{}(C)\ TID\ \%ld\ |\ Gerente\ finalizou.\ Não\ há\ mais\ produtores\ nem\ vendas\ a\ processar.\(\backslash\)n"{}},\ pthread\_self());}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00252}00252\ \ \ \ \ pthread\_exit(NULL);}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00253}00253\ \}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00254}00254\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00266}\mbox{\hyperlink{prod-cons_8c_ae66f6b31b5ad750f1fe042a706a4e3d4}{00266}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{prod-cons_8c_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}}()}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00267}00267\ \{}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00268}00268\ \ \ \ \ pthread\_t\ producers[\mbox{\hyperlink{prod-cons_8c_a35219978a46af884c0f14963e979dbad}{NUM\_PRODUCERS}}];}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00269}00269\ \ \ \ \ pthread\_t\ consumers[\mbox{\hyperlink{prod-cons_8c_a642ed9b3c92cf525bd21bc6b630e1eed}{NUM\_CONSUMERS}}];}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00270}00270\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00271}00271\ \ \ \ \ srand(time(NULL));}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00272}00272\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00273}00273\ \ \ \ \ pthread\_mutex\_init(\&\mbox{\hyperlink{prod-cons_8c_a4acff8232e4aec9cd5c6dc200ac55ef3}{mutex}},\ NULL);}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00274}00274\ \ \ \ \ pthread\_cond\_init(\&\mbox{\hyperlink{prod-cons_8c_a87c6d5157fa0f10d82e0abded1d885f3}{buffer\_full\_cond}},\ NULL);}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00275}00275\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00276}00276\ \ \ \ \ sem\_init(\&\mbox{\hyperlink{prod-cons_8c_ac4b4123acdd4ff1886c11fd9b0918f19}{empty\_slots}},\ 0,\ \mbox{\hyperlink{prod-cons_8c_a6b20d41d6252e9871430c242cb1a56e7}{BUFFER\_SIZE}});}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00277}00277\ \ \ \ \ sem\_init(\&\mbox{\hyperlink{prod-cons_8c_ab0f9446b575ad1c8a51548638b7af8e0}{full\_slots}},\ 0,\ 0);}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00278}00278\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00279}00279\ \ \ \ \ printf(\textcolor{stringliteral}{"{}-\/-\/-\/\ Iniciando\ Simulação\ de\ Gerenciamento\ de\ Caixas\ -\/-\/-\/\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00280}00280\ \ \ \ \ printf(\textcolor{stringliteral}{"{}Configuração:\ \%d\ Produtores\ (Caixas),\ \%d\ Consumidor\ (Gerente),\ Tamanho\ do\ Buffer:\ \%d\(\backslash\)n\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00281}00281\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{prod-cons_8c_a35219978a46af884c0f14963e979dbad}{NUM\_PRODUCERS}},\ \mbox{\hyperlink{prod-cons_8c_a642ed9b3c92cf525bd21bc6b630e1eed}{NUM\_CONSUMERS}},\ \mbox{\hyperlink{prod-cons_8c_a6b20d41d6252e9871430c242cb1a56e7}{BUFFER\_SIZE}});}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00282}00282\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00283}00283\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{prod-cons_8c_a35219978a46af884c0f14963e979dbad}{NUM\_PRODUCERS}};\ i++)}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00284}00284\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00285}00285\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structproducer__args}{producer\_args}}\ *args\ =\ malloc(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structproducer__args}{producer\_args}}));}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00286}00286\ \ \ \ \ \ \ \ \ args-\/>\mbox{\hyperlink{structproducer__args_ab488bfc5d1f76143651f915915046354}{thread\_id}}\ =\ i\ +\ 1;}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00287}00287\ \ \ \ \ \ \ \ \ args-\/>\mbox{\hyperlink{structproducer__args_ade4eec1ec53e96b62203ac10a9126465}{num\_sales}}\ =\ (rand()\ \%\ 11)\ +\ 20;\ \textcolor{comment}{//\ Cada\ produtor\ fará\ entre\ 20\ e\ 30\ vendas}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00288}00288\ \ \ \ \ \ \ \ \ pthread\_create(\&producers[i],\ NULL,\ \mbox{\hyperlink{prod-cons_8c_a13f485a0cfd6e52c071bef0b7adb70cf}{producer}},\ (\textcolor{keywordtype}{void}\ *)args);}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00289}00289\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00290}00290\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00291}00291\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{prod-cons_8c_a642ed9b3c92cf525bd21bc6b630e1eed}{NUM\_CONSUMERS}};\ i++)}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00292}00292\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00293}00293\ \ \ \ \ \ \ \ \ pthread\_create(\&consumers[i],\ NULL,\ \mbox{\hyperlink{prod-cons_8c_a6c0ce21bf6fb29cd5d2d0b367f315da1}{consumer}},\ NULL);}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00294}00294\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00295}00295\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00296}00296\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{prod-cons_8c_a35219978a46af884c0f14963e979dbad}{NUM\_PRODUCERS}};\ i++)}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00297}00297\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00298}00298\ \ \ \ \ \ \ \ \ pthread\_join(producers[i],\ NULL);}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00299}00299\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00300}00300\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00301}00301\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{prod-cons_8c_a642ed9b3c92cf525bd21bc6b630e1eed}{NUM\_CONSUMERS}};\ i++)}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00302}00302\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00303}00303\ \ \ \ \ \ \ \ \ pthread\_join(consumers[i],\ NULL);}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00304}00304\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00305}00305\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00306}00306\ \ \ \ \ pthread\_mutex\_destroy(\&\mbox{\hyperlink{prod-cons_8c_a4acff8232e4aec9cd5c6dc200ac55ef3}{mutex}});}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00307}00307\ \ \ \ \ pthread\_cond\_destroy(\&\mbox{\hyperlink{prod-cons_8c_a87c6d5157fa0f10d82e0abded1d885f3}{buffer\_full\_cond}});}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00308}00308\ \ \ \ \ sem\_destroy(\&\mbox{\hyperlink{prod-cons_8c_ac4b4123acdd4ff1886c11fd9b0918f19}{empty\_slots}});}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00309}00309\ \ \ \ \ sem\_destroy(\&\mbox{\hyperlink{prod-cons_8c_ab0f9446b575ad1c8a51548638b7af8e0}{full\_slots}});}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00310}00310\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00311}00311\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n-\/-\/-\/\ Simulação\ Concluída\ -\/-\/-\/\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00312}00312\ }
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00313}00313\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{prod-cons_8c_source_l00314}00314\ \}}

\end{DoxyCode}
